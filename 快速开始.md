# 🚀 快速开始指南

## 📥 下载项目

访问GitHub仓库: https://github.com/lakymoon/manus-2026-01-14

点击绿色的 "Code" 按钮,选择 "Download ZIP" 下载项目文件。

---

## 💻 在Windows上使用

### 方法一: 使用可执行文件(推荐)

**适合**: 不熟悉编程的用户

#### 第1步: 打包程序

1. 解压下载的ZIP文件
2. 双击运行 `一键打包.bat`
3. 等待自动安装依赖和打包(首次需要几分钟)
4. 打包完成后会自动打开 `dist` 文件夹

#### 第2步: 使用程序

1. 在 `dist` 文件夹中找到 `库存表管理系统.exe`
2. 双击运行程序
3. 界面说明:
   - **输入文件**: 点击"浏览"选择你的库存Excel文件
   - **输出文件**: 自动生成,也可以自定义
   - **运行日志**: 显示处理进度和结果
4. 点击 "🚀 开始处理" 按钮
5. 等待处理完成,查看生成的销售清单

#### 第3步: 查看结果

打开生成的Excel文件,你会看到:
- 原有的 BondDataSheet 和 TemplateSheet
- 新增的销售清单工作表(每个客户两个版本)
- "入账"列已自动标记为"是"

---

### 方法二: 使用Python脚本

**适合**: 熟悉Python的用户

#### 前置要求

- 已安装 Python 3.7 或更高版本
- 如果没有,请访问 https://www.python.org/downloads/ 下载安装

#### 使用步骤

1. 打开命令提示符(CMD)或PowerShell
2. 进入项目目录:
   ```bash
   cd 你的下载路径\manus-2026-01-14
   ```

3. 安装依赖:
   ```bash
   pip install openpyxl
   ```

4. 运行GUI版本:
   ```bash
   python improve_inventory_gui.py
   ```

5. 或者运行命令行版本:
   ```bash
   # 将你的Excel文件改名为 库存tmep.xlsx 并放在同一目录
   python improve_inventory.py
   ```

---

## 📋 Excel文件要求

### 必需的工作表

1. **BondDataSheet**: 包含库存数据
   - 必须是Excel表格对象(Table),名称为 `BondDataTable`
   - 必需的列: 序号、出库日期、规格、个数、毛重、除皮、净重、出库对象、入账、备注

2. **TemplateSheet**: 销售清单模板
   - 用于生成简单版销售清单
   - 保持原有格式即可

### 数据格式

- **出库日期**: 日期格式或文本格式(YYYY-MM-DD)
- **毛重/除皮/净重**: 数字格式
- **出库对象**: 客户名称(文本)
- **入账**: 空白或"是"

---

## ⚙️ 功能说明

### 自动序号

新增行时,序号会自动生成。公式: `=ROW(BondDataTable[[#This Row],[序号]])-1`

### 自动日期

运行程序时,空白的出库日期会自动填充为当天日期。

### 自动净重

净重列使用公式自动计算: `=毛重-除皮`

### 自动生成销售清单

程序会按照"出库日期 + 出库对象"分组,为每组生成两个销售清单:

1. **简单版**: 基于TemplateSheet,保持原有风格
2. **详细版**: 格式规范,包含详细明细和汇总

### 自动入账标记

生成销售清单后,对应的数据行会在"入账"列自动标记为"是",避免重复生成。

---

## 🎯 使用场景示例

### 场景1: 日常出库记录

1. 在 BondDataSheet 中新增出库记录
2. 填写: 规格、个数、毛重、除皮、出库对象
3. 序号和净重会自动生成
4. 暂时不用管出库日期和入账

### 场景2: 月末生成销售清单

1. 运行程序(GUI版或命令行版)
2. 程序自动:
   - 为空白日期填充当天日期
   - 按客户和日期生成销售清单
   - 标记已入账
3. 打开生成的Excel文件
4. 查看各个客户的销售清单
5. 手动填写单价和金额(如需要)
6. 打印或导出PDF给客户

### 场景3: 重新处理某些数据

如果需要重新生成某些销售清单:

1. 在 BondDataSheet 中,将对应行的"入账"列清空
2. 重新运行程序
3. 程序只会处理"入账"列为空的数据

---

## ❓ 常见问题

### Q1: 打包时提示"未检测到Python环境"?

**A**: 需要先安装Python:
1. 访问 https://www.python.org/downloads/
2. 下载Python 3.8或更高版本
3. 安装时务必勾选 "Add Python to PATH"
4. 重启命令提示符,再次运行打包脚本

### Q2: 程序运行后没有生成销售清单?

**A**: 可能的原因:
- 所有数据的"入账"列都已标记为"是"
- 数据中缺少出库日期或出库对象
- 检查运行日志中的提示信息

### Q3: 生成的销售清单中单价和金额是空的?

**A**: 这是正常的,单价和金额需要手动填写。程序只负责:
- 统计件数
- 计算总重量
- 列出明细净重

### Q4: 如何修改销售清单的格式?

**A**: 
- **简单版**: 修改 TemplateSheet 工作表
- **详细版**: 修改 `improve_inventory_gui.py` 中的 `create_detailed_invoice` 函数

### Q5: 可以在Mac或Linux上使用吗?

**A**: 可以使用Python脚本版本:
```bash
pip install openpyxl
python improve_inventory_gui.py
```

但无法打包成.exe文件(仅Windows支持)。

---

## 📞 获取帮助

如果遇到问题:

1. 查看 [使用说明.md](./使用说明.md) 了解详细功能
2. 查看 [打包说明.md](./打包说明.md) 了解打包细节
3. 在GitHub仓库提交Issue
4. 查看程序运行日志中的错误信息

---

## 🎉 开始使用

现在你已经了解了所有基础知识,可以开始使用程序了!

**建议的第一次使用流程**:

1. 备份你的原始Excel文件
2. 使用 `一键打包.bat` 生成可执行文件
3. 双击运行 `库存表管理系统.exe`
4. 选择你的Excel文件
5. 点击"开始处理"
6. 查看生成的结果

祝使用愉快! 🚀
